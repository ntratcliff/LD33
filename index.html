<html>
<head>
    <title>LD33</title>
    <link href="styles/jquery.terminal.css" rel="stylesheet" />
    <link href="styles/terminal.custom.css" rel="stylesheet" />
    <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
    <script src="scripts/jquery.terminal-0.8.8.js"></script>
    <script>
        var man = {
            "help": {
                "desc": "Returns a list of commands, or information about a command.",
                "usage": "help <command>"
            },
            "list": {
                "desc": "Lists all objects in current area.",
                "usage": "list"
            },
            "inspect": {
                "desc": "Forces your host to inspect an object.",
                "usage": "inspect <object>"
            },
            "grab": {
                "desc": "Coherces your host into grabbing up an object.",
                "usage": "grab <object>"
            },
            "put": {
                "desc": "Puts down an object held by your host.",
                "usage": "put <object>"
            },
            "toss": {
                "desc": "Strongly suggests to your host that throwing an object is a good idea.",
                "usage": "toss <object>"
            },
            "hit": {
                "desc": "Forces your host to hit something.",
                "usage": "hit <object>"
            },
            "use": {
                "desc": "Causes host to use item as deemed appropriate.",
                "usage": "use <object>"
            },
            "restart": {
                "desc": "Discards this host and starts with a fresh one.",
                "usage": "restart"
            },
        };

        var rooms = {
            "bedroom": {
                "desc": "A mid-sized appartment bedroom furnished with a [[b;;;]bed], [[b;;;]wardrobe], [[b;;]poster], and [[b;;;]nightstand].\nThere is an [[b;;;]alarmclock] on the [[b;;;]nightstand].\nLight is streaming in through a [[b;;;]window] on the wall.\nThere is also a [[b;;;]door].",
                "objects": ["host", "room", "alarmclock", "nightstand", "window", "bed", "door", "wardrobe", "poster"],
            },
            "street": {
                "desc": "It is a bright and sunny day. Your host thinks it is a lovely day to go to work.\nHere, your host finds a [[b;;;]busstop] and an unknown [[b;;;]human].",
                "objects": ["human", "busstop"], 
            },
            "office": {
                "desc": "\"Every day is a great day for office work!\" thinks your host. Your host may be too optimistic.\nHere, yours host finds its [[b;;;]boss], a [[b;;;]coworker], its [[b;;;]cubicle], and the [[b;;;]door].",
                "objects": ["boss", "coworker", "cubicle", "door"],
            },
        }

        //$.ajax({
        //    dataType: "json",
        //    url: "man.json",
        //    data: man,
        //    async: false
        //});

        function GameObject(id, name, description, properties, actions) {
            this.id = id;
            this.name = name;
            this.description = description;
            this.properties = properties;
            this.actions = actions;

            //functions
            this.getDescription = function () {
                var updatedDescription = this.description;
                var regex = /%(.+?)%/g
                while (match = regex.exec(this.description)) {
                    updatedDescription = this.description.replace(/%(.+?)%/, properties[match[1]])
                }
                return updatedDescription;
            };

            this.onTossed = function (term) {
                if (!properties.canToss)
                    term.echo("Your host can not toss [[b;;;]" + name + "].");

                term.echo("The object lands softly.");
            }

            this.onHit = function (term) {
                term.echo("Your host hits [[b;;;]" + name + "].");
            }

            this.onUse = function (term) {
                term.echo("There is no apparent use for [[b;;;]" + name + "] now.");
            }
        }

        var gameObjects = {
            "alarmclock": new GameObject(
                0,
                "alarmclock",
                "An [[b;;;]alarmclock]. It is %ringstatus%.",
                {
                    "ringstatus": "ringing",
                    "canTake": true,
                    "canToss": true,
                    "broken": false,
                },
                []),
            "host": new GameObject(
                1,
                "host",
                "Your host. It has two hands. It is not ringing.",
                {
                    "canTake": false,
                    "canToss": false,
                    "holding": null,
                    "isOnDrugs": false,
                    "isBloody": false,
                    "isDressed": false,
                },
                []),
            "room": new GameObject(
                2,
                "room",
                "A generic room.",
                {
                    "canTake": false,
                    "canToss": false,
                    "broken": false,
                },
                []),
            "nightstand": new GameObject(
                3,
                "nightstand",
                "A wooden nightstand.",
                {
                    "canTake": true,
                    "canToss": true,
                    "hasAlarmClock": true,
                    "used": false,
                },
                []),
            "window": new GameObject(
                4,
                "window",
                "A glass window. Light streams in from outside.",
                {
                    "canTake": false,
                    "canToss": false,
                    "broken": false,
                },
                []),
            "bed": new GameObject(
                5,
                "bed",
                "A bed.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "drugs": new GameObject(
                6,
                "drugs",
                "Probably not legal, and probably very fun.",
                {
                    "canTake": true,
                    "canToss": true,

                },
                []),
            "door": new GameObject(
                7,
                "door",
                "A door.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "human": new GameObject(
                8,
                "human",
                "A human. It is of average height and weight. It is not ringing.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "boss": new GameObject(
                9,
                "boss",
                "Your host's employer. Your host holds the opinion of [[b;;;]boss] in high regard.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "coworker": new GameObject(
                10,
                "coworker",
                "A human who works in the same office as your host. It looks as if it is not doing any productive work.",
                {
                    "canTake": false,
                    "canToss": false,
                    "dinnerPlans": false,
                },
                []),
            "cubicle": new GameObject(
                11,
                "cubicle",
                "A standard workstation. There are many like it throughout the office floor.\nHowever, this cubicle is your host's.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "busstop": new GameObject(
                12,
                "busstop",
                "A place where humans wait for transportation. Your host requires this transportation to get to work.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
            "wardrobe": new GameObject(
                13,
                "wardrobe",
                "A wooden wardrobe. Your host is under the impression that if it were to [[b;;;]use] the wardrobe, it would find [[b;;;]clothes].",
                {
                    "canTake": false,
                    "canToss": false,
                    "used": false,
                },
                []),
            "clothes": new GameObject(
                14, 
                "clothes",
                "A professional work outfit. Your host believes that were it to [[b;;;]use] the [[b;;;]clothes] it would no longer be undressed.",
                {
                    "canTake": true,
                    "canToss": true,
                },
                []),
            "poster": new GameObject(
                15,
                "poster",
                "A poster of the planet pluto with a ring shaped like a heart surrounding it. Your host finds this poster heartwarming and uplifting.\nIt believes there is hope for pluto yet.",
                {
                    "canTake": false,
                    "canToss": false,
                },
                []),
        };

        gameObjects.alarmclock.onTossed = function (term) {

            this.description = "Pieces of what was once an [[b;;;]alarmclock]. They are %ringstatus%.";
            echo("The [[b;;;]alarmclock] hits a nearby wall and shatters.");
            if (roomObjects.nightstand && roomObjects.nightstand.properties.hasAlarmClock) {
                roomObjects.nightstand.properties.hasAlarmClock = false;
            }

            if (this.properties.ringstatus == "ringing") {
                echo("The alarm stops.");
                this.properties.ringstatus = "not ringing";
            }
            this.properties.canTake = false;
            this.properties.canToss = false;
            this.properties.broken = true;

        }

        gameObjects.alarmclock.onHit = function (term) {
            if (this.properties.ringstatus == "ringing") {
                this.properties.ringstatus = "not ringing";
                echo("The [[b;;;]alarmclock] stops ringing.");
            }
            else {
                echo("Your host hits [[b;;;]alarmclock].");
            }
        }

        gameObjects.alarmclock.onUse = function (term) {
            if (!this.properties.broken) {
                echo("Your host presses a button on the [[b;;;]alarmclock].");
                if (this.properties.ringstatus == "ringing") {
                    this.properties.ringstatus = "not ringing";
                    echo("The [[b;;;]alarmclock] stops ringing.");
                }
                else {
                    echo("Nothing happens.");
                }
            }
            else {
                echo("Your host does not know what do to with a pile of clock bits.");
            }
        }

        //gameObjects.host.onTossed = function (term) {
        //    echo("Despite its best efforts, the host can not throw itself.");
        //}

        gameObjects.host.onHit = function (term) {
            echo("The host hits itself. This is unfortunate.");
        }

        gameObjects.nightstand.onTossed = function (term) {
            this.description += " It is lying on its side.";

            echo("Your host struggles, but eventually knocks over the [[b;;;]nightstand].");

            if (this.properties.hasAlarmClock) {
                echo("The [[b;;;]alarmclock] falls off of the [[b;;;]nightstand] and hits the ground.");
                if (roomObjects.alarmclock.properties.ringstatus == "ringing") {
                    echo("The [[b;;;]alarmclock] stops ringing.");
                    roomObjects.alarmclock.properties.ringstatus = "not ringing";
                }
            }

            this.properties.canToss = false;
        }

        gameObjects.nightstand.onUse = function (term) {
            if (this.properties.used) {
                echo("There is no apparent use for [[b;;;]nightstand] now.");
                return;
            }
            addToRoom("drugs");
            this.properties.used = true;
            echo("Your host opens the [[b;;;]nightstand] drawer.");
            echo("Inside, it finds [[b;;;]drugs].");
        }

        gameObjects.wardrobe.onUse = function (term) {
            if (this.properties.used) {
                echo("There is no apparent use for [[b;;;]nightstand] now.");
                return;
            }
            addToRoom("clothes");
            this.properties.used = true;
            echo("Your host opens the [[b;;;]wardrobe].");
            echo("Inside, it finds [[b;;;]clothes].");
        }

        gameObjects.human.onUse = function (term) {
            echo("Your host approaches the [[b;;;]human] and attempts to make conversation.");
            term.pause();
            setTimeout(function () { echo("..."); }, 1000);
            setTimeout(function () {
                if (roomObjects.host.properties.isDressed) {
                    echo("Your host successfully makes meaningless conversation with the [[b;;;]human].\nYour host feels good about its social skills.");
                }
                else {
                    echo("The [[b;;;]human] screams and runs away.\nYour host feels bad about its terrible social skills.");
                    roomObjects["human"] = null;
                    //TODO: remove human from room desc
                }
                term.resume();
            }, 2500);
        }

        //TODO: hit human

        gameObjects.boss.onUse = function (term) {
            echo("Your host approaches its [[b;;;]boss] and greets it.");
            term.pause();
            setTimeout(function () { echo("..."); }, 1000);
            setTimeout(function () {
                if (roomObjects.host.properties.isBloody)
                    echo("Your host's [[b;;;]boss] notes concern over the blood all over your host.");
                echo("Your host's boss demands that your host get to work.");
                setTimeout(function () {
                    echo("Your host is satisfied with the interaction, and feels prepared to work.");
                    term.resume();
                }, 1500);
            }, 2500);
        }

        gameObjects.coworker.onUse = function (term) {
            echo("Your host approaches [[b;;;]coworker] and greets it.");
            term.pause();
            setTimeout(function () { echo("..."); }, 1000);
            setTimeout(function () {
                if (roomObjects.coworker.properties.dinnerPlans) { //go to supply room
                    if (roomObjects.host.properties.isBloody)
                        echo("Disregarding the blood covering your host's entire body, its [[b;;;]coworker] engages in conversation with it.");
                    echo("The [[b;;;]coworker] offers to skip dinner plans.");
                    setTimeout(function () {
                        echo("Your host agrees.");
                    }, 1500);
                    setTimeout(function () {
                        echo("The [[b;;;]coworker] invites your host to the supplies room.");
                    }, 3000);
                    setTimeout(function () {
                        echo("Your host agrees.");
                    }, 4500);
                    setTimeout(function () { echo("..."); }, 6000);
                    setTimeout(function () {
                        echo("Your host now has an intimate relationship.");
                    }, 7500);
                    setTimeout(function () {
                        loseGame(term);
                    }, 9000)
                }
                else { //make dinner plans

                    if (roomObjects.host.properties.isBloody)
                        echo("Despite your host being covered with blood, its [[b;;;]coworker] engages in conversation with it.");
                    echo("The [[b;;;]coworker] notes that it does not talk with your host often.");
                    setTimeout(function () {
                        echo("Your host agrees.");
                    }, 1500);
                    setTimeout(function () {
                        echo("The [[b;;;]coworker] states that it would like to know your host better.");
                    }, 3000);
                    setTimeout(function () {
                        echo("Your host agrees.");
                    }, 4500);
                    setTimeout(function () { echo("..."); }, 6000);
                    setTimeout(function () {
                        echo("Your host now has dinner plans.");
                        roomObjects.coworker.properties.dinnerPlans = true;
                        term.resume();
                    }, 7500);

                }
            }, 2500);
        }

        gameObjects.boss.onHit = function (term) {
            term.pause();
            echo("Your host hits its [[b;;;]boss]");
            setTimeout(function () {
                echo("...");
            }, 1000);
            setTimeout(function () {
                echo("Your host's boss becomes enraged and fires your host.");
            }, 2000);
            setTimeout(function () {
                echo("Your host is very distressed at this matter.");
            }, 3500);
            setTimeout(function () {
                loseGame(term);
            }, 5000);
        }

        gameObjects.coworker.onHit = function (term) {
            term.pause();
            echo("Your host hits [[b;;;]coworker]");
            setTimeout(function () {
                echo("...");
            }, 1000);
            setTimeout(function () {
                echo("The [[b;;;]coworker] begins to cry.");
            }, 2000);
            setTimeout(function () {
                echo("Your host's boss becomes enraged and fires your host.");
            }, 3000);
            setTimeout(function () {
                echo("Your host is very distressed at this matter.");
            }, 4500);
            setTimeout(function () {
                loseGame(term);
            }, 6000);
        }

        gameObjects.cubicle.onUse = function (term) {
            term.pause();
            echo("Your host takes a seat at its cubicle and begins to work.");
            setTimeout(function () {
                echo("...");
            }, 1000);
            setTimeout(function () {
                winGame(term);
            }, 2000);
        }

        function dropNonTransferrableObjects(term) {
            if (roomObjects.host.properties.holding != roomObjects["drugs"] 
                && roomObjects.host.properties.holding != roomObjects["clothes"]) { //put down object (if it's not drugs) so it can be removed
                term.exec("put " + roomObjects.host.properties.holding.name, true);
            }
        }

        gameObjects.door.onUse = function (term) {
            if (currentRoom == rooms["bedroom"]) {
                //go to street
                dropNonTransferrableObjects(term);
                removeFromRoom("alarmclock");
                removeFromRoom("nightstand");
                removeFromRoom("window");
                removeFromRoom("bed");
                removeFromRoom("door");
                removeFromRoom("wardrobe");
                removeFromRoom("poster");

                if (roomObjects.host.properties.holding != roomObjects["drugs"])
                    removeFromRoom("drugs");

                if (roomObjects.host.properties.holding != roomObjects["clothes"])
                    removeFromRoom("clothes");

                term.pause();
                echo("Your host opens the [[b;;;]door], and exits through it.");
                setTimeout(function () { echo("..."); }, 1000);
                setTimeout(function () {
                    loadRoom("street");
                    echo("Your host enters [[b;;;]street].");
                    roomObjects["street"] = roomObjects["room"];
                    term.resume();
                }, 2000);
            }
            else {
                //leaving office, lose game
                term.pause();
                echo("Your host opens the [[b;;;]door], and exits through it.");
                setTimeout(function () { echo("..."); }, 1000);
                setTimeout(function () {
                    echo("Your host has decides that it does not need to work on such a nice day.");
                    
                }, 2500);
                setTimeout(function () {
                    loseGame(term);
                }, 4000);
            }
        }

        gameObjects.busstop.onUse = function (term) {
            //go to office if dressed. Jail if not
            echo("Your host waits patiently for a bus.");
            term.pause();
            setTimeout(function () {
                echo("...");
                setTimeout(function () {
                    if (roomObjects.host.properties.isDressed) {
                        dropNonTransferrableObjects(term);
                        removeFromRoom("human");
                        removeFromRoom("busstop");
                        removeFromRoom("street");
                        echo("A bus arrives, and your host boards.");
                        setTimeout(function () { echo("..."); }, 1000);
                        setTimeout(function () {
                            loadRoom("office");
                            echo("Your host enters [[b;;;]office].");
                            roomObjects["office"] = roomObjects["room"];
                            term.resume();
                        }, 2000);
                    }
                    else { //jail
                        echo("A police officer approaches the bus stop cautiously.");
                        setTimeout(function () { echo("The police officer places your host under arrest for public nudity."); }, 1500);
                        setTimeout(function () { loseGame(term); }, 3000);
                    }
                }, 1000);
            }, 1000);
        }

        gameObjects.drugs.onUse = function (term) {
           
            echo("Your host ingests the [[b;;;]drugs].");
            if (roomObjects.host.properties.holding == this)
                roomObjects.host.properties.holding = null;

            removeFromRoom("drugs");
            
            term.pause();
            setTimeout(function () {
                echo("...")
            }, 1000);
            setTimeout(function () {
                echo("WARNING: Connection to host unstable.")
            }, 2000);
            setTimeout(function () {
                roomObjects.host.properties.isOnDrugs = true;
                echo("WARNING: Abnormal brain chemistry detected!")
            }, 3500);
            setTimeout(function () {
                term.resume()
            }, 4500);
        }

        gameObjects.clothes.onUse = function (term) {
            echo("Your host dons the [[b;;;]clothes]");
            if (roomObjects.host.properties.holding == this)
                roomObjects.host.properties.holding = null;

            roomObjects.host.properties.isDressed = true;

            removeFromRoom("clothes");
        }

        var currentRoom;
        var roomObjects = {};

        function loadRoom(room) {
            currentRoom = rooms[room];
            for (i = 0; i < currentRoom.objects.length; i++) {
                roomObjects[currentRoom.objects[i]] = jQuery.extend({}, gameObjects[currentRoom.objects[i]]);
            }
            roomObjects.room.description = currentRoom.desc;
        }

        function addToRoom(item){
            roomObjects[item] = jQuery.extend({}, gameObjects[item]);
        }

        function removeFromRoom(item) {
            delete roomObjects[item];
        }

        function winGame(term) {
            term.pause();
            echo();
            roomObjects = new Array(); //empty room
            echo("System detects that host has accomplished scheduled goal.");
            setTimeout(function () {
                echo("To begin again with another host, type [[b;;;]restart].");
                term.resume();
            }, 1500);

        }
        
        function loseGame(term) {
            term.pause();
            echo();
            roomObjects = new Array(); //empty room
            echo("ERROR: Connection to host lost.");
            setTimeout(function () {
                echo("You have failed to successfully get your host to work.");
                echo("You may try again with another host by entering command [[b;;;]restart]");
                term.resume();
            }, 1500);
        }

        loadRoom("bedroom");

        var drugCounter = 10;

        function echo(msg) {
            if (msg && roomObjects.host && roomObjects.host.properties.isOnDrugs && drugCounter-- > 0) {
                var replacements = getRandomInt(Math.round(msg.length / 8), Math.round(msg.length / 4))
                for (i = 0; i < replacements; i++) {
                    
                    var charPlace = getRandomInt(0, msg.length);
                    if (!msg[charPlace].match(/ |\[|]|;|b/)) {
                        msg = msg.substr(0, charPlace) + getRandomChar() + msg.substr(charPlace + 1)
                    }
                }
            }
            else if (drugCounter <= 0) {
                //TODO: replace some descriptions
            }

            terminal.echo(msg);
        }

        function getRandomInt(min, max) {
            return Math.round(Math.floor(Math.random() * (max - min)) + min);
        }

        var chars = ['€', 'Œ', '‰', 'Ž', '¡', 'º', 'Σ', 'ë', '¿', '@', '!', '$', '%', '^', '&', '>', '>'];
        function getRandomChar() {
            return chars[getRandomInt(0, chars.length)];
        }

        var terminal; //exposed for debug purposes
        $(function () {
            terminal = $('#game-terminal').terminal({
                help: function (arg) {
                    if (arg) {
                        if (man[arg]) {
                            echo("[[b;;;]" + arg + "]: " + man[arg].desc);
                            echo("Usage: " + man[arg].usage);
                        }
                        else {
                            echo("There is no help text for [[b;;;]" + arg + "].");
                        }
                    }
                    else {
                        if (man) {
                            echo("[[b;;;]help]: " + man["help"].desc);
                            echo("Usage: " + man["help"].usage);
                            echo();
                            echo("Commands: ");
                            var line = "";
                            var charCount = 0;
                            for (var command in man) {
                                line += command + " ";
                                charCount += command.length;
                                if (charCount >= 30) {
                                    echo(line);
                                    line = "";
                                    charCount = 0;
                                }
                            }
                            if (charCount > 0) {
                                echo(line);
                            }

                            echo();
                            echo("Protip: You should probably start with the command \"inspect room\"");
                        }
                    }
                    
                },
                inspect: function (arg) {
                    if (arg) {
                        if (roomObjects[arg]) {
                            echo(roomObjects[arg].getDescription());
                        }
                        else {
                            echo("There doesn't seem to be a [[b;;;]" + arg + "] around.");
                        }
                    }
                    else if(roomObjects.host){
                        echo("Your host stares blankly into space.");
                    }
                },
                grab: function (arg) {
                    if (arg) {
                        if (roomObjects[arg] 
                            && roomObjects[arg].properties.canTake 
                            && roomObjects.host.properties.holding == null) {
                            roomObjects.host.properties.holding = roomObjects[arg];
                            echo("Your host picks up [[b;;;]" + arg + "].");
                        }
                        else if (roomObjects[arg] 
                            && roomObjects.host.properties.holding != null 
                            && roomObjects.host.properties.holding != roomObjects[arg])
                        {
                            echo("Your host is currently too occupied with the [[b;;;]" + roomObjects.host.properties.holding.name + "] it is holding.");
                        }
                        else if (roomObjects[arg]
                            && roomObjects.host.properties.holding == roomObjects[arg])
                        {
                            echo("Your host is already holding [[b;;;]" + arg + "].");
                            echo("There is not yet a way to hold two of the same item at the same time.");
                            echo("If you figure one out, publish a paper on it.");
                        }
                        else if (roomObjects[arg]) {
                            echo("Your host can not pick up [[b;;;]" + arg + "].");
                        }
                        else {
                            echo("There is no [[b;;;]" + arg + "] here.");
                        }
                    }
                    else if (roomObjects.host){
                        echo("Your host grasps at the air aimlessly.");
                    }
                },
                put: function (arg) {
                    if (arg) {
                        if (roomObjects.host.properties.holding == roomObjects[arg]) {
                            roomObjects.host.properties.holding = null;
                            echo("Your host drops [[b;;;]" + arg + "].");
                        }
                        else if (roomObjects.host){
                            echo("Your host is not holding [[b;;;]" + arg + "].");
                        }
                    }
                },
                toss: function (arg) {
                    if (arg) {
                        if (roomObjects[arg] && roomObjects[arg].properties.canToss && roomObjects.host.properties.holding == roomObjects[arg]) { //todo: check if host is holding object
                            roomObjects.host.properties.holding = null;
                            roomObjects[arg].onTossed(this);
                        }
                        else if (roomObjects[arg] && roomObjects.host.properties.holding != roomObjects[arg]) {
                            echo("Your host is not holding [[b;;;]" + arg + "].");
                        }
                        else if (roomObjects[arg]) {
                            echo("Your host can not toss [[b;;;]" + arg + "].");
                        }
                        else {
                            echo("There is no [[b;;;]" + arg + "] here.");
                        }
                    }
                    else if (roomObjects.host){
                        echo("Your host flails their arms.");
                    }
                },
                hit: function (arg) {
                    if (arg) {
                        if (roomObjects[arg]) { //room has object
                            roomObjects[arg].onHit(this);
                        }
                        else {
                            echo("There is no [[b;;;]" + arg + "] here.");
                        }
                    }
                    else if (roomObjects.host){
                        echo("Your host punches the air. This is somewhat unnecessary.");
                    }
                },
                use: function (arg) {
                    if(arg) {
                        if(roomObjects[arg]){
                            roomObjects[arg].onUse(this);
                        }
                        else {
                            echo("There is no [[b;;;]" + arg + "] here.");
                        }
                    }
                    else if (roomObjects.host) {
                        echo("You can't use nothing.");
                    }
                },
                watchme: function () {
                    echo("Your host begins to do the nae nae...");
                    this.pause();
                    setTimeout(function () {
                        window.open("https://www.youtube.com/watch?v=vjW8wmF5VWc");
                    }, 1000);
                    this.resume();
                },
                restart: function () {
                    location.reload();
                },
                list: function () {
                    var line = "";
                    var charCount = 0;
                    for (var obj in roomObjects) {
                        line += obj + " ";
                        charCount += obj.length;
                        if (charCount >= 30) {
                            echo("[[b;;;]"+line+"]");
                            line = "";
                            charCount = 0;
                        }
                    }
                    if (charCount > 0) {
                        echo("[[b;;;]" + line + "]");
                    }

                }
            },
            {
                prompt: '>',
                exit: false,
                clear: false,
                greetings: false,
                checkArity: false,
                onInit: function (term) {
                    term.echo("==================================================================================");
                    term.echo();
                    term.echo("__/\\\\\\________/\\\\\\_______/\\\\\\\\\\__________/\\\\\\\\\\\\\\\\\\\\\\____/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_        ");
                    term.echo(" _\\/\\\\\\_______\\/\\\\\\_____/\\\\\\///\\\\\\______/\\\\\\/////////\\\\\\_\\///////\\\\\\/////__       ");
                    term.echo("  _\\/\\\\\\_______\\/\\\\\\___/\\\\\\/__\\///\\\\\\___\\//\\\\\\______\\///________\\/\\\\\\_______      ");
                    term.echo("   _\\/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\__/\\\\\\______\\//\\\\\\___\\////\\\\\\_______________\\/\\\\\\_______     ");
                    term.echo("    _\\/\\\\\\/////////\\\\\\_\\/\\\\\\_______\\/\\\\\\______\\////\\\\\\____________\\/\\\\\\_______    ");
                    term.echo("     _\\/\\\\\\_______\\/\\\\\\_\\//\\\\\\______/\\\\\\__________\\////\\\\\\_________\\/\\\\\\_______   ");
                    term.echo("      _\\/\\\\\\_______\\/\\\\\\__\\///\\\\\\__/\\\\\\_____/\\\\\\______\\//\\\\\\________\\/\\\\\\_______  ");
                    term.echo("       _\\/\\\\\\_______\\/\\\\\\____\\///\\\\\\\\\\/_____\\///\\\\\\\\\\\\\\\\\\\\\\/_________\\/\\\\\\_______ ");
                    term.echo("        _\\///________\\///_______\\/////_________\\///////////___________\\///________");
                    term.echo("                                     __   ___  ");
                    term.echo("                                    /_ | / _ \\ ");
                    term.echo("                               __   _| || | | |");
                    term.echo("                               \\ \\ / / || | | |");
                    term.echo("                                \\ V /| || |_| |");
                    term.echo("                                 \\_/ |_(_)___/ ");
                    term.echo();
                    term.echo("                           Type \"help\" for assistance");
                    term.echo("==================================================================================");
                },
            });
        });

    </script>
</head>
<body>

    <div id="game-terminal"></div>
    <div id="i" class="overlay" onclick="$('#game-terminal').focus();"></div>
</body>
</html>
